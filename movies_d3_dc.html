<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Bar Charts with dc and crossfilter</title>
     <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/dc.css">
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/crossfilter.js" charset="utf-8"></script>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="js/dc.js" charset="utf-8"></script>


</head>
<body>
    <div id="block">
        <div id="title">
             <a href="index.html" style="text-decoration:none; color:#0927a0;">Works - Scientific Visualization</a>
             <div id="subtitle">
                 Author: Danilo Borges da Silva
             </div>
        </div>
        <div id="pagework"> 
            <div id="pageworktitle">Class Work 3</div>
            <div id="pageworkdate">04th May 2016</div>
            <div id="pageworkdescription">          
                 <p style="float:left">
                 Bar chart: Year (dimension) x Worldwide Gross (group).
                 </p>
                 <center><div id="chartBar1" style="border: 1px solid #eee; padding: 10px; display:block;"></div></center>
                 <br><br>

                 <p style="float:left">
                 Bar chart: Genre (dimension) x Worldwide Gross (group).
                 </p>
                 <center><div id="chartBar2" style="border: 1px solid #eee; padding: 10px;display:block;" ></div></center>
                 <br>


        </div>      
    </div>
    <script type="text/javascript">
            var fluctuationChart = dc.barChart('#chartBar1');
            var fluctuationChart2 = dc.barChart('#chartBar2');

            d3.json("movies.json", function(error, data){
			// formatando nossos dados
            data.forEach(function(d){
                d.Year = +d.Year;
                d.Worldwide_Gross_M = +d.Worldwide_Gross_M;
                d.Budget_M = +d.Budget_M;
            });

            //criando um crossfilter
            var facts = crossfilter(data);

            var yearDim = facts.dimension(function(d){
                return d.Year;
            });

            var genreDim = facts.dimension(function(d){
                return d.Genre;
            });

            var WorldwideByYearGroup = yearDim.group().reduceSum(function(d){
                return d.Worldwide_Gross_M;
            });

            var WorldwideByGenreGroup = genreDim.group().reduceSum(function(d){
                return d.Worldwide_Gross_M;
            });


//var sortByGenre = WorldwideByGenreGroup.sort(function (a, b) { return a < b; });
//var WorldwideByGenreGroup = WorldwideByGenreGroup.map(function (d) { return d; });

           
    fluctuationChart
        .width(620)
        .height(380)
        .margins({top: 20, right: 50, bottom: 30, left: 40})
        .dimension(yearDim)
        .group(WorldwideByYearGroup)        
        .centerBar(true)
        .alwaysUseRounding(true)
        .renderHorizontalGridLines(true)
        .x(d3.scale.linear().domain([2006, 2012]))
        .gap(15)
        .xAxisLabel('Year')
        .yAxisLabel('Worldwide Gross');
        
        fluctuationChart.xAxis().tickFormat(d3.format("d"));
        
   fluctuationChart2.width(620)
        .height(380)
        .margins({top: 20, right: 50, bottom: 30, left: 40})
        .dimension(genreDim)        
        .renderHorizontalGridLines(true)
        .x(d3.scale.ordinal().domain(genreDim))
        .xUnits(dc.units.ordinal)
        .gap(15)
        .centerBar(false)
        .group(WorldwideByGenreGroup)
        .xAxisLabel('Genre')
        .yAxisLabel('Worldwide Gross')
        .ordering();
        
                     
        dc.renderAll();

		});
	</script>
    
				
</body>
</html>
